# Dockerized iRedMail.
# Run all mail server applications in one container - except MariaDB.
FROM ubuntu:jammy
LABEL maintainer Zhang Huangbin <zhb@iredmail.org>
EXPOSE 80 443 25 465 587 143 993 110 995 4190

COPY ./add_system_accounts.sh ./install_all_pkgs.sh /entrypoint.sh /

RUN /bin/sh /add_system_accounts.sh && \
    /bin/sh /install_all_pkgs.sh && \
    rm -rf /add_system_accounts.sh /install_all_pkgs.sh

COPY ./gosible/gosible /gosible

# Sample config file for testing purpose.
# It should be generated by a web UI.
COPY ./gosible/settings.json /settings.json

ENTRYPOINT ["/bin/bash", "/entrypoint.sh"]
CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/supervisord.conf"]
